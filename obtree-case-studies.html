<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Obtree Case Studies</title>
<!--        <meta name="keywords" content="JCMS,JCMS Consulting,jcms,jcms consulting,web development,bespoke development,website best practice,website optimisation,consultancy,obtree cms,obtree wcm,obtree,obtree cms training,obtree training,case studies">-->
        <meta name="description" content="Case Studies of recent Obtree WCM work performed by JCMS"> 
        
        <meta property="og:title" content="Obtree Case Studies" />
        <meta property="og:type" content="article" />
        <meta property="og:url" content="https://www.jcms-consulting.co.uk/obtree-case-studies.html" />
        <meta property="og:image" content="https://www.jcms-consulting.co.uk/images/logos/logo-large-green.jpg" />
        <meta property="og:image:type" content="image/jpeg" />
        <meta property="og:image:width" content="200" />
        <meta property="og:image:height" content="200" />
        <meta property="og:description" content="Case Studies of recent Obtree WCM work performed by JCMS" />
        
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/js/libs/pure/pure.css" rel="stylesheet" type="text/css">
        <link href="/js/libs/pure/grids-responsive.css" rel="stylesheet" type="text/css">
        <link href="/js/libs/jqueryui/jquery-ui.css" rel="stylesheet" type="text/css">
        <link href="/js/libs/pure/pure.css" rel="stylesheet" type="text/css">
        <link href="/js/libs/pure/grids-responsive.css" rel="stylesheet" type="text/css">
        <link href="/css/wufoo/form.css" rel="stylesheet" type="text/css">
        <link href="/css/wufoo/structure.css" rel="stylesheet" type="text/css">
        <link href="/css/jcms.css" rel="stylesheet" type="text/css">
        
        <link rel="canonical" href="https://www.jcms-consulting.co.uk/obtree-case-studies.html">
        <link rel="icon" type="image/gif" href="https://www.jcms-consulting.co.uk/images/logo-tiny.gif">
        
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-89678431-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-89678431-2');
</script>

    </head>

    <body class="jcms-green">
        <div class="pure-g row-smaller heading green">
            <div class="pure-u-1">
                <a href="/" title="Home">
                    <img class="inline-logo" src="/images/logos/logo-large-green.jpg" alt="JCMS Logo"/>
                </a>
                <div class="strapline"><h1>Obtree Case Studies</h1></div>
            </div>
        </div>

        <div class="pure-g" id="body-content">
            
            <!-- content blocks -->
            
            <!-- logo/title -->
            <div class="pure-u-1 linkpanel row">
                <div class="panel-title"><h2>Hounslow Borough Council Cludo Search integration</h2></div>
                <div class="panel-text">
                    <h3>Overview</h3>
                    <p>
                        Hounslow Borough Council (HBC), a long-time Obtree WCM customer tasked JCMS with implementing an integration between Obtree and <a href="https://www.cludo.com" title="Cludo Search" target="_blank">Cludo Search</a>. This included both the then public facing website and the intranet, both of which were powered by Obtree WCM. <i>(Note: The public facing site is no longer powered by Obtree)</i> 
                    </p>
                    <p>Cludo offer a remote indexing service, with corresponding search being implemented via a simple JavaScript plugin and - for intranet content - a server-side authentication module. Therefore, customer source content that needs indexing must be available remotely for indexing purposes. As such, integration with HBC public site was straightforward (because all pages are available freely on the web). Integration with the intranet site was more challenging, because of the requirement for proxy authentication.</p>
                </div>
                <div class="panel-text">
                    <h3>Public facing site</h3>
                    <p>
                        The Cludo working model is to analyse the customer source HTML and provide a document describing the HTML and JavaScript alterations required to implement the integration. Therefore, the JCMS requirement was essentially to perform straightforward Obtree WCM template changes to satisfy the Cludo integration document. 
                    </p>
                    <p>These included some HTML alterations and some additional inline and referenced JavaScript. The key values set in the JavaScript configuration object were the customer ID and Site ID - so that the AJAX request for search results would retrieve matches from the correct customer and site - don't forget, the data is all held remotely on the Cludo servers.</p>
                    <p>
                        The results were presented as a simple paginated list.
                    </p>
                </div>
                
                <div class="panel-text">
                    <h3>Intranet site</h3>
                    <p>
                        The requirement for remote indexing of the <b>internal</b> content meant that the implementation for the intranet was considerably more involved. The required steps can be summarised as:
                    </p>
                    <ul>
                        <li>HBC needed to allow remote access to servers behind the firewall. (i.e. to a rendered instance of the intranet)</li>
                        <li>Cludo needed to access this opened tunnel and crawl the content.</li>
                        <li>Because this content is private to HBC, but stored on the potentially publicly available Cludo servers, access to search results must be restricted</li>
                        <li>HBC needed to implement a secure server side proxy providing an authentication token to gain access to the crawled content</li>
                        <li>Therefore, HBC needed to provide access to the Cludo servers from the intranet client machines <b>and</b> from the intranet web server</li>
                        <li>HBC needed to implement the client-side JavaScript that tied this all together</li>
                    </ul>
                </div>
                <div class="panel-text">
                    <h4>Indexing</h4>
                    <p>Allowing access to the material to be indexed required a network and firewall configuration change. This task was performed by the HBC network administrators. The subsequent indexing and storage was performed remotely by Cludo. Therefore, JCMS was not involved with this step.</p>
                </div>
                <div class="panel-text">   
                    <h4>Search result access</h4>
                    <p>As noted, access to the indexed content required that a server-side authentication token was passed as part of the search request. This required a combination of tasks. The underlying network connectivity to allow search requests to reach the Cludo servers from within the HBC firewalled intranet was realised by HBC network administrators.</p>
                    <p>
                        The realisation of the server-side proxy and the subsequent CMS integration and template changes to realise the client-side JavaScript were performed by JCMS.
                    </p>
                </div>
                <div class="panel-text">
                    <h4>Authentication proxy development</h4>
                    <p>The initial instructions provided by Cludo for intranet integration only included client-side HTML and JavaScript integration. Although a HBC-specific authentication token was provided in addition to the customer and (different) site IDs, it was unclear how this should be used. Eventually, a <a href='https://github.com/Cludo/ApiExample' title='GitHub Cludo API example repository' target="_blank">GitHub repository location</a> was provided that contained a C# skeleton code for the server-side proxy.</p>
                    <p>
                        This was a .NET 4.5 application with various hooks for authentication, a test HTML and JavaScript file and, crucially, a configuration file with a placeholder for a customer key. Once the HBC customer key was entered into the web.config file and the site and customer IDs added to the client side JavaScript configuration, HBC-specific search results were presented in the test HTML file.
                    </p>
                    <figure>
                        <img src="/images/hbc-cludo-vs-screenshot.png" alt="Cludo proxy web.config with customer key"/>
                        <figcaption>Cludo proxy web.config with customer key</figcaption>
                    </figure>
                    
                </div>
                
                <div class="panel-text">
                    <h4>IIS setup</h4> 
                    <p>
                        The Cludo proxy code runs as an IIS application, so a suitable virtual directory, pointing at the Cludo C# code, was added and converted to an IIS application. The virtual path becomes important later on for the integration with the Obtree WCM system. 
                    </p>
                    <figure>
                        <img src="/images/iis-cludo-application.png" alt="IIS Cludo Application"/>
                        <figcaption>IIS Cludo Application</figcaption>
                    </figure>
                    <figure>
                        <img class="small" src="/images/iis-cludo-config.png" alt="IIS Cludo Application configuration"/>
                        <figcaption>IIS Cludo Application configuration</figcaption>
                    </figure>
                </div>
                
                
                <div class="panel-text">
                    <h4>Client side script and proxy testing</h4>                    
                    <p>
                        The GitHub skeleton code contains a sample HTML file that can be used to test the application. This has some inline javascript that embeds the remote Cludo javascript. The inline JavaScript was amended with the customer key and site ID and this, coupled with the server-side key held in the server-side code meant that sufficient authentication is sent with the search query request to allow Cludo to both identify the customer and site, and to ensure that the request for secure data has come from a server that has sent a valid customer token. 
                    </p>
                    <p>
                        The simple test harness is sufficient to confirm that the intranet site has been indexed and that the credentials are valid, as shown below. 
                    </p>
                    <figure>
                        <img class="small" src="/images/hbc-cludo-testfile-screenshot-1.png" alt="Initial view of demo search screen"/>
                        <figcaption>Initial view of demo search screen</figcaption>
                    </figure>
                    
                    <figure>
                        <img class="small" src="/images/hbc-cludo-testfile-screenshot-2.png" alt="View of demo search screen with autocomplete"/>
                        <figcaption>View of demo search screen with autocomplete</figcaption>
                    </figure>
                    
                    <figure>
                        <img src="/images/hbc-cludo-testfile-screenshot-3.png" alt="View of demo page with search results"/>
                        <figcaption>View of demo page with search results</figcaption>
                    </figure>
                </div>
                <div class="panel-text">
                    <h4>Integration between Obtree WCM and Cludo proxy</h4>
                    
                    <p>The Cludo proxy URL needed to be on a path of the same domain as the intranet, so that the client-side AJAX JavaScript did not encounter any cross origin request problems.</p>
                    <p>However, Obtree CMS works by intercepting all requests for a given domain (or path in that domain) and attempting to dynamically serve content held in it's own repository. It is of course possible to configure the system to ignore requests on certain paths with so-called <code>EXCLUDEMAGIC</code> entries in the configuration file</p>
                    <p>
                        Therefore, in addition to the simple template modifications to include the HTML and JavaScript changes, the Obtree configuration was adapted with an <code>EXCLUDEMAGIC</code> entry matching the IIS Application name set when the Cludo code was added to the IIS website running the Obtree engine. This is shown in the following screenshot:
                    </p>
                    <figure>
                        <img class="small" src="/images/hbc-cludo-cfg-screenshot.png" alt="Obtree configuration to exclude a specified path"/>
                        <figcaption>Obtree configuration to exclude a specified path</figcaption>
                    </figure>
                    <p>
                        This configuration change ensured that any HTTP requests that included <code>/cludosearch/</code> in the URL would not be processed by the Obtree engine, but passed through to IIS to handle (in this case, the Cludo .NET application).
                    </p>
                </div>
                <div class="panel-text">
                    <h4>CMS template integration</h4>
                    <p>
                        The final step was to implement the HTML and JavaScript changes detailed by Cludo following their analysis of the rendered sourcecode. Essentially, the existing search form was re-used, but a DOM identifier added to allow the Cludo code to initialise with the existing search markup. The appropriate initialisation object was also embedded as inline JavaScript to load all required remote libraries and to ensure the correct output DOM targets and format were specified. 
                    </p>
                    <figure>
                        <img src="/images/hbc-obtree-screenshot-1.png" alt="Obtree template showing JavaScript Cludo configuration object"/>
                        <figcaption>Obtree template showing JavaScript Cludo configuration object</figcaption>
                    </figure>
                    <p>
                        Unlike the internet content, the <i>intranet</i> content was indexed with facet attributes, and the results are presented with a breakdown of matches per facet. Each displayed facet is a filter for the current result list. This output is all generated by the Cludo controller code. For example, a search for 'councillors':
                    </p>
                    <figure>
                        <img class="small" src="/images/hbc-render-no-facets-screenshot.png" alt="Search outcome showing all matching results and available facets"/>
                        <figcaption>Search outcome showing all matching results and available facets</figcaption>
                    </figure>
                    <figure>
                        <img class="small" src="/images/hbc-render-facet-screenshot.png" alt="Search outcome showing all matching results filtered by a facet"/>
                        <figcaption>Search outcome showing all matching results filtered by a facet</figcaption>
                    </figure>
                </div>
<!--                <div class="panel-text">
                    <h3>Summary</h3>
                    <p></p>
                </div>-->
            </div>
            

        </div>
        <div class="pure-g divider">
            <div class="pure-u-1"></div>
        </div>
        <div class="pure-g row-tiny" id="footer"></div>
        <script src="/js/libs/jquery/jquery.js" type="text/javascript"></script>    
        <script src="/js/libs/jquery.color/jquery.color.2.1.2.js" type="text/javascript"></script>
        <script src="/js/libs/jqueryui/jquery-ui.js" type="text/javascript"></script>
        <script src="/js/jcms-controller-static.js" type="text/javascript"></script>
    </body>
</html>